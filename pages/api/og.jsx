import { ImageResponse } from "@vercel/og";

export const config = {
  runtime: "experimental-edge",
};

export default function handler(req) {
  try {
    const { searchParams } = new URL(req.url);
    const paramsTitle = searchParams.get("title");
    const paramsCompany = searchParams.get("company");

    const title = paramsTitle
      ? decodeURIComponent(paramsTitle?.slice(0, 100))
      : null;
    const company = paramsCompany
      ? decodeURIComponent(paramsCompany?.slice(0, 100))
      : null;

    return new ImageResponse(
      (
        <div
          style={{
            height: "100%",
            width: "100%",
            display: "flex",
            flexDirection: "column",
            alignItems: "center",
            justifyContent: "center",
            backgroundColor: "#fff",
            fontWeight: 600,
            padding: "0 100px",
            textAlign: "center",
          }}
        >
          <div style={{ display: "flex", top: 60, position: "absolute" }}>
            <svg
              width="430"
              height="60"
              viewBox="0 0 430 60"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M192.948 44.436V15.528H197.088V44.436H192.948ZM227.976 31.62L226.896 32.7V39H222.288V14.772H226.86H227.184V15.132C227.064 15.276 226.98 15.432 226.932 15.6C226.908 15.768 226.896 16.056 226.896 16.464V27.732L232.728 21.972C232.92 22.02 233.136 22.068 233.376 22.116C233.616 22.14 233.856 22.164 234.096 22.188C234.336 22.212 234.564 22.236 234.78 22.26C234.996 22.26 235.176 22.26 235.32 22.26H237.588L231.036 28.812L238.416 38.964L233.376 39.144L227.976 31.62ZM247.56 39.432C246.36 39.432 245.244 39.24 244.212 38.856C243.18 38.448 242.28 37.872 241.512 37.128C240.768 36.384 240.18 35.472 239.748 34.392C239.316 33.312 239.1 32.088 239.1 30.72C239.1 29.328 239.304 28.08 239.712 26.976C240.144 25.848 240.72 24.9 241.44 24.132C242.16 23.364 243 22.776 243.96 22.368C244.944 21.96 246 21.756 247.128 21.756C248.112 21.756 249.036 21.936 249.9 22.296C250.788 22.632 251.568 23.148 252.24 23.844C252.936 24.54 253.476 25.404 253.86 26.436C254.268 27.468 254.472 28.656 254.472 30C254.472 30.264 254.472 30.588 254.472 30.972C254.472 31.356 254.46 31.68 254.436 31.944H243.528C243.576 32.616 243.72 33.204 243.96 33.708C244.224 34.188 244.548 34.596 244.932 34.932C245.34 35.244 245.784 35.484 246.264 35.652C246.768 35.796 247.272 35.868 247.776 35.868C248.28 35.868 248.748 35.832 249.18 35.76C249.636 35.664 250.068 35.508 250.476 35.292C250.908 35.076 251.316 34.764 251.7 34.356L254.004 36.624C253.452 37.272 252.84 37.812 252.168 38.244C251.496 38.652 250.764 38.952 249.972 39.144C249.204 39.336 248.4 39.432 247.56 39.432ZM243.564 28.524H250.08C250.08 27.996 250.008 27.528 249.864 27.12C249.744 26.712 249.54 26.376 249.252 26.112C248.988 25.848 248.664 25.656 248.28 25.536C247.896 25.392 247.452 25.32 246.948 25.32C246.516 25.32 246.108 25.38 245.724 25.5C245.34 25.62 244.992 25.812 244.68 26.076C244.392 26.34 244.152 26.676 243.96 27.084C243.768 27.492 243.636 27.972 243.564 28.524ZM257.964 22.152H262.68L262.644 26.832L262.14 26.58C262.212 25.86 262.404 25.212 262.716 24.636C263.028 24.036 263.424 23.52 263.904 23.088C264.408 22.656 264.948 22.332 265.524 22.116C266.124 21.876 266.736 21.756 267.36 21.756C268.32 21.756 269.184 21.912 269.952 22.224C270.72 22.536 271.428 23.028 272.076 23.7L270.168 27.588L270.06 27.876L269.7 27.732C269.628 27.54 269.556 27.336 269.484 27.12C269.436 26.904 269.28 26.652 269.016 26.364C268.68 26.124 268.32 25.92 267.936 25.752C267.552 25.584 267.132 25.5 266.676 25.5C266.1 25.5 265.56 25.596 265.056 25.788C264.576 25.956 264.156 26.232 263.796 26.616C263.436 27 263.148 27.492 262.932 28.092C262.716 28.668 262.608 29.376 262.608 30.216V39H257.964V22.152ZM279.24 45.336C278.064 45.336 277.008 45.108 276.072 44.652C275.136 44.22 274.272 43.572 273.48 42.708L275.964 39.432L276.18 39.18L276.504 39.36C276.552 39.552 276.588 39.744 276.612 39.936C276.66 40.152 276.804 40.416 277.044 40.728C277.332 40.992 277.644 41.196 277.98 41.34C278.34 41.508 278.76 41.592 279.24 41.592C279.816 41.592 280.284 41.472 280.644 41.232C281.004 40.992 281.256 40.62 281.4 40.116C281.544 39.636 281.616 39.036 281.616 38.316V25.752H275.856V22.152H286.26V37.884C286.26 39.66 285.924 41.1 285.252 42.204C284.58 43.308 283.704 44.1 282.624 44.58C281.568 45.084 280.44 45.336 279.24 45.336ZM283.632 19.596C282.864 19.596 282.204 19.344 281.652 18.84C281.124 18.312 280.86 17.688 280.86 16.968C280.86 16.2 281.112 15.564 281.616 15.06C282.144 14.556 282.816 14.304 283.632 14.304C284.376 14.304 285.024 14.568 285.576 15.096C286.152 15.624 286.44 16.248 286.44 16.968C286.44 17.688 286.152 18.312 285.576 18.84C285.024 19.344 284.376 19.596 283.632 19.596ZM296.628 39.432C294.804 39.432 293.376 39 292.344 38.136C291.312 37.248 290.796 36.096 290.796 34.68C290.796 33.768 290.988 32.94 291.372 32.196C291.78 31.428 292.38 30.756 293.172 30.18C293.988 29.604 295.008 29.16 296.232 28.848C297.456 28.512 298.884 28.344 300.516 28.344C300.66 28.344 300.852 28.356 301.092 28.38C301.332 28.38 301.596 28.38 301.884 28.38C302.172 28.38 302.436 28.392 302.676 28.416L302.784 31.512C302.592 31.488 302.34 31.476 302.028 31.476C301.74 31.476 301.44 31.476 301.128 31.476C300.816 31.476 300.564 31.476 300.372 31.476C299.364 31.476 298.536 31.548 297.888 31.692C297.264 31.812 296.76 31.992 296.376 32.232C296.016 32.472 295.764 32.748 295.62 33.06C295.476 33.372 295.404 33.708 295.404 34.068C295.404 34.38 295.452 34.668 295.548 34.932C295.668 35.172 295.824 35.364 296.016 35.508C296.208 35.628 296.436 35.724 296.7 35.796C296.988 35.868 297.288 35.904 297.6 35.904C298.248 35.904 298.812 35.796 299.292 35.58C299.772 35.364 300.168 35.028 300.48 34.572C300.816 34.092 301.056 33.492 301.2 32.772C301.368 32.028 301.452 31.152 301.452 30.144C301.452 28.824 301.32 27.816 301.056 27.12C300.792 26.424 300.42 25.944 299.94 25.68C299.46 25.416 298.86 25.284 298.14 25.284C297.396 25.284 296.688 25.404 296.016 25.644C295.368 25.86 294.708 26.316 294.036 27.012L291.48 24.312C292.488 23.376 293.58 22.716 294.756 22.332C295.956 21.948 297.144 21.756 298.32 21.756C299.352 21.756 300.324 21.876 301.236 22.116C302.172 22.356 302.988 22.752 303.684 23.304C304.404 23.832 304.968 24.576 305.376 25.536C305.784 26.472 305.988 27.648 305.988 29.064V39H301.308V37.416C300.996 37.776 300.672 38.088 300.336 38.352C300.024 38.616 299.676 38.832 299.292 39C298.908 39.144 298.5 39.252 298.068 39.324C297.636 39.396 297.156 39.432 296.628 39.432ZM310.668 29.352V25.68H321.324V29.352H310.668ZM326.652 39V35.328H331.008V20.244H326.868V16.572H339.684V20.244H335.328V35.328H339.864V39H326.652ZM348.18 39V20.388H342.276V16.572H358.8V20.388H352.536V39H348.18ZM367.44 39.468C366.6 39.468 365.892 39.18 365.316 38.604C364.764 38.028 364.488 37.332 364.488 36.516C364.488 35.7 364.764 35.016 365.316 34.464C365.892 33.888 366.6 33.6 367.44 33.6C368.232 33.6 368.916 33.888 369.492 34.464C370.068 35.016 370.356 35.7 370.356 36.516C370.356 37.332 370.068 38.028 369.492 38.604C368.916 39.18 368.232 39.468 367.44 39.468ZM386.016 39.432C384.792 39.432 383.64 39.228 382.56 38.82C381.504 38.388 380.58 37.788 379.788 37.02C378.996 36.228 378.384 35.304 377.952 34.248C377.52 33.192 377.304 32.028 377.304 30.756C377.304 29.508 377.52 28.344 377.952 27.264C378.384 26.16 378.996 25.2 379.788 24.384C380.58 23.568 381.504 22.932 382.56 22.476C383.64 21.996 384.804 21.756 386.052 21.756C387.66 21.756 389.052 22.044 390.228 22.62C391.404 23.196 392.34 24.012 393.036 25.068L390.552 27.804L390.3 28.056L390.012 27.84C389.988 27.648 389.952 27.456 389.904 27.264C389.88 27.048 389.748 26.784 389.508 26.472C389.076 26.04 388.584 25.752 388.032 25.608C387.504 25.44 386.892 25.356 386.196 25.356C385.62 25.356 385.08 25.476 384.576 25.716C384.072 25.956 383.616 26.304 383.208 26.76C382.8 27.216 382.476 27.78 382.236 28.452C382.02 29.124 381.912 29.904 381.912 30.792C381.912 31.56 382.032 32.268 382.272 32.916C382.512 33.54 382.824 34.068 383.208 34.5C383.616 34.908 384.072 35.232 384.576 35.472C385.104 35.688 385.644 35.796 386.196 35.796C386.7 35.796 387.18 35.736 387.636 35.616C388.116 35.472 388.584 35.256 389.04 34.968C389.52 34.656 389.976 34.236 390.408 33.708L392.892 36.588C391.98 37.596 390.9 38.328 389.652 38.784C388.428 39.216 387.216 39.432 386.016 39.432ZM402.324 39.396C400.812 39.396 399.444 39.036 398.22 38.316C396.996 37.572 396.024 36.54 395.304 35.22C394.584 33.876 394.224 32.328 394.224 30.576C394.224 28.92 394.584 27.432 395.304 26.112C396.024 24.768 396.996 23.712 398.22 22.944C399.444 22.152 400.812 21.756 402.324 21.756C403.836 21.756 405.204 22.152 406.428 22.944C407.676 23.712 408.66 24.768 409.38 26.112C410.124 27.432 410.496 28.92 410.496 30.576C410.496 32.304 410.124 33.84 409.38 35.184C408.66 36.504 407.676 37.536 406.428 38.28C405.204 39.024 403.836 39.396 402.324 39.396ZM402.324 35.76C403.044 35.76 403.668 35.544 404.196 35.112C404.748 34.68 405.18 34.08 405.492 33.312C405.804 32.52 405.96 31.608 405.96 30.576C405.96 29.472 405.804 28.536 405.492 27.768C405.18 27 404.748 26.412 404.196 26.004C403.668 25.596 403.044 25.392 402.324 25.392C401.652 25.392 401.04 25.596 400.488 26.004C399.96 26.412 399.54 27 399.228 27.768C398.916 28.536 398.76 29.472 398.76 30.576C398.76 31.608 398.916 32.52 399.228 33.312C399.54 34.08 399.96 34.68 400.488 35.112C401.04 35.544 401.652 35.76 402.324 35.76ZM411.648 39V22.152H415.392V23.232C415.68 22.872 415.968 22.584 416.256 22.368C416.568 22.152 416.88 21.996 417.192 21.9C417.528 21.804 417.852 21.756 418.164 21.756C418.548 21.756 418.908 21.816 419.244 21.936C419.604 22.056 419.94 22.248 420.252 22.512C420.564 22.776 420.816 23.16 421.008 23.664C421.272 23.208 421.56 22.848 421.872 22.584C422.208 22.296 422.592 22.092 423.024 21.972C423.456 21.828 423.936 21.756 424.464 21.756C425.088 21.756 425.616 21.876 426.048 22.116C426.504 22.332 426.864 22.656 427.128 23.088C427.416 23.496 427.62 24.012 427.74 24.636C427.884 25.236 427.956 25.932 427.956 26.724V39H424.068V27.588C424.068 26.94 424.032 26.436 423.96 26.076C423.912 25.716 423.828 25.452 423.708 25.284C423.588 25.116 423.432 25.032 423.24 25.032C422.976 25.032 422.712 25.164 422.448 25.428C422.208 25.668 422.004 26.028 421.836 26.508C421.692 26.988 421.62 27.588 421.62 28.308V39H417.984V27.66C417.984 26.556 417.912 25.824 417.768 25.464C417.624 25.104 417.372 24.924 417.012 24.924C416.82 24.924 416.628 24.996 416.436 25.14C416.268 25.26 416.112 25.464 415.968 25.752C415.824 26.016 415.716 26.34 415.644 26.724C415.572 27.108 415.536 27.564 415.536 28.092V39H411.648Z"
                fill="black"
              />
              <path
                d="M7.056 32.208L5.688 34.152V42H1.26V19.572H5.652H5.976V19.932C5.856 20.076 5.772 20.232 5.724 20.4C5.7 20.568 5.688 20.856 5.688 21.264V28.392L12.528 19.356C12.72 19.404 12.948 19.44 13.212 19.464C13.476 19.488 13.752 19.512 14.04 19.536C14.328 19.56 14.592 19.572 14.832 19.572C15.072 19.572 15.264 19.572 15.408 19.572H17.604L10.26 28.896L17.964 41.964L12.852 42.144L7.056 32.208ZM27 42.432C25.8 42.432 24.684 42.24 23.652 41.856C22.62 41.448 21.72 40.872 20.952 40.128C20.208 39.384 19.62 38.472 19.188 37.392C18.756 36.312 18.54 35.088 18.54 33.72C18.54 32.328 18.744 31.08 19.152 29.976C19.584 28.848 20.16 27.9 20.88 27.132C21.6 26.364 22.44 25.776 23.4 25.368C24.384 24.96 25.44 24.756 26.568 24.756C27.552 24.756 28.476 24.936 29.34 25.296C30.228 25.632 31.008 26.148 31.68 26.844C32.376 27.54 32.916 28.404 33.3 29.436C33.708 30.468 33.912 31.656 33.912 33C33.912 33.264 33.912 33.588 33.912 33.972C33.912 34.356 33.9 34.68 33.876 34.944H22.968C23.016 35.616 23.16 36.204 23.4 36.708C23.664 37.188 23.988 37.596 24.372 37.932C24.78 38.244 25.224 38.484 25.704 38.652C26.208 38.796 26.712 38.868 27.216 38.868C27.72 38.868 28.188 38.832 28.62 38.76C29.076 38.664 29.508 38.508 29.916 38.292C30.348 38.076 30.756 37.764 31.14 37.356L33.444 39.624C32.892 40.272 32.28 40.812 31.608 41.244C30.936 41.652 30.204 41.952 29.412 42.144C28.644 42.336 27.84 42.432 27 42.432ZM23.004 31.524H29.52C29.52 30.996 29.448 30.528 29.304 30.12C29.184 29.712 28.98 29.376 28.692 29.112C28.428 28.848 28.104 28.656 27.72 28.536C27.336 28.392 26.892 28.32 26.388 28.32C25.956 28.32 25.548 28.38 25.164 28.5C24.78 28.62 24.432 28.812 24.12 29.076C23.832 29.34 23.592 29.676 23.4 30.084C23.208 30.492 23.076 30.972 23.004 31.524ZM37.404 25.152H42.12L42.084 29.832L41.58 29.58C41.652 28.86 41.844 28.212 42.156 27.636C42.468 27.036 42.864 26.52 43.344 26.088C43.848 25.656 44.388 25.332 44.964 25.116C45.564 24.876 46.176 24.756 46.8 24.756C47.76 24.756 48.624 24.912 49.392 25.224C50.16 25.536 50.868 26.028 51.516 26.7L49.608 30.588L49.5 30.876L49.14 30.732C49.068 30.54 48.996 30.336 48.924 30.12C48.876 29.904 48.72 29.652 48.456 29.364C48.12 29.124 47.76 28.92 47.376 28.752C46.992 28.584 46.572 28.5 46.116 28.5C45.54 28.5 45 28.596 44.496 28.788C44.016 28.956 43.596 29.232 43.236 29.616C42.876 30 42.588 30.492 42.372 31.092C42.156 31.668 42.048 32.376 42.048 33.216V42H37.404V25.152ZM58.68 48.336C57.504 48.336 56.448 48.108 55.512 47.652C54.576 47.22 53.712 46.572 52.92 45.708L55.404 42.432L55.62 42.18L55.944 42.36C55.992 42.552 56.028 42.744 56.052 42.936C56.1 43.152 56.244 43.416 56.484 43.728C56.772 43.992 57.084 44.196 57.42 44.34C57.78 44.508 58.2 44.592 58.68 44.592C59.256 44.592 59.724 44.472 60.084 44.232C60.444 43.992 60.696 43.62 60.84 43.116C60.984 42.636 61.056 42.036 61.056 41.316V28.752H55.296V25.152H65.7V40.884C65.7 42.66 65.364 44.1 64.692 45.204C64.02 46.308 63.144 47.1 62.064 47.58C61.008 48.084 59.88 48.336 58.68 48.336ZM63.072 22.596C62.304 22.596 61.644 22.344 61.092 21.84C60.564 21.312 60.3 20.688 60.3 19.968C60.3 19.2 60.552 18.564 61.056 18.06C61.584 17.556 62.256 17.304 63.072 17.304C63.816 17.304 64.464 17.568 65.016 18.096C65.592 18.624 65.88 19.248 65.88 19.968C65.88 20.688 65.592 21.312 65.016 21.84C64.464 22.344 63.816 22.596 63.072 22.596ZM76.068 42.432C74.244 42.432 72.816 42 71.784 41.136C70.752 40.248 70.236 39.096 70.236 37.68C70.236 36.768 70.428 35.94 70.812 35.196C71.22 34.428 71.82 33.756 72.612 33.18C73.428 32.604 74.448 32.16 75.672 31.848C76.896 31.512 78.324 31.344 79.956 31.344C80.1 31.344 80.292 31.356 80.532 31.38C80.772 31.38 81.036 31.38 81.324 31.38C81.612 31.38 81.876 31.392 82.116 31.416L82.224 34.512C82.032 34.488 81.78 34.476 81.468 34.476C81.18 34.476 80.88 34.476 80.568 34.476C80.256 34.476 80.004 34.476 79.812 34.476C78.804 34.476 77.976 34.548 77.328 34.692C76.704 34.812 76.2 34.992 75.816 35.232C75.456 35.472 75.204 35.748 75.06 36.06C74.916 36.372 74.844 36.708 74.844 37.068C74.844 37.38 74.892 37.668 74.988 37.932C75.108 38.172 75.264 38.364 75.456 38.508C75.648 38.628 75.876 38.724 76.14 38.796C76.428 38.868 76.728 38.904 77.04 38.904C77.688 38.904 78.252 38.796 78.732 38.58C79.212 38.364 79.608 38.028 79.92 37.572C80.256 37.092 80.496 36.492 80.64 35.772C80.808 35.028 80.892 34.152 80.892 33.144C80.892 31.824 80.76 30.816 80.496 30.12C80.232 29.424 79.86 28.944 79.38 28.68C78.9 28.416 78.3 28.284 77.58 28.284C76.836 28.284 76.128 28.404 75.456 28.644C74.808 28.86 74.148 29.316 73.476 30.012L70.92 27.312C71.928 26.376 73.02 25.716 74.196 25.332C75.396 24.948 76.584 24.756 77.76 24.756C78.792 24.756 79.764 24.876 80.676 25.116C81.612 25.356 82.428 25.752 83.124 26.304C83.844 26.832 84.408 27.576 84.816 28.536C85.224 29.472 85.428 30.648 85.428 32.064V42H80.748V40.416C80.436 40.776 80.112 41.088 79.776 41.352C79.464 41.616 79.116 41.832 78.732 42C78.348 42.144 77.94 42.252 77.508 42.324C77.076 42.396 76.596 42.432 76.068 42.432Z"
                fill="black"
              />
              <rect x="101" width="60" height="60" rx="12" fill="black" />
              <path
                d="M115.412 42V38.328H119.768V23.244H115.628V19.572H128.444V23.244H124.088V38.328H128.624V42H115.412ZM136.94 42V23.388H131.036V19.572H147.56V23.388H141.296V42H136.94Z"
                fill="white"
              />
            </svg>
          </div>
          <div
            style={{
              marginTop: 40,
              fontSize: 40,
              fontWeight: 600,
            }}
          >
            {title}
          </div>
          {company && (
            <div style={{ marginTop: 10, fontSize: 24, color: "#6B7280" }}>
              {company}
            </div>
          )}
        </div>
      ),
      {
        width: 1200,
        height: 630,
      }
    );
  } catch (e) {
    console.log(`${e.message}`);
    return new Response(`Failed to generate the image`, {
      status: 500,
    });
  }
}
