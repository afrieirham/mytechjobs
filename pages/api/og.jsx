import { ImageResponse } from "@vercel/og";

export const config = {
  runtime: "experimental-edge",
};

export default function handler(req) {
  try {
    const { searchParams } = new URL(req.url);
    const paramsTitle = searchParams.get("title");
    const paramsCompany = searchParams.get("company");

    const title = paramsTitle
      ? decodeURIComponent(paramsTitle?.slice(0, 100))
      : null;
    const company = paramsCompany
      ? decodeURIComponent(paramsCompany?.slice(0, 100))
      : null;

    return new ImageResponse(
      (
        <div
          style={{
            height: "100%",
            width: "100%",
            display: "flex",
            flexDirection: "column",
            alignItems: "center",
            justifyContent: "center",
            backgroundColor: "#fff",
            fontWeight: 600,
            padding: "0 100px",
            textAlign: "center",
          }}
        >
          <div style={{ display: "flex", top: 60, position: "absolute" }}>
            <svg
              width="305"
              height="70"
              viewBox="0 0 305 70"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M104.416 39.62L103.336 40.7V47H98.728V22.772H103.3H103.624V23.132C103.504 23.276 103.42 23.432 103.372 23.6C103.348 23.768 103.336 24.056 103.336 24.464V35.732L109.168 29.972C109.36 30.02 109.576 30.068 109.816 30.116C110.056 30.14 110.296 30.164 110.536 30.188C110.776 30.212 111.004 30.236 111.22 30.26C111.436 30.26 111.616 30.26 111.76 30.26H114.028L107.476 36.812L114.856 46.964L109.816 47.144L104.416 39.62ZM124 47.432C122.8 47.432 121.684 47.24 120.652 46.856C119.62 46.448 118.72 45.872 117.952 45.128C117.208 44.384 116.62 43.472 116.188 42.392C115.756 41.312 115.54 40.088 115.54 38.72C115.54 37.328 115.744 36.08 116.152 34.976C116.584 33.848 117.16 32.9 117.88 32.132C118.6 31.364 119.44 30.776 120.4 30.368C121.384 29.96 122.44 29.756 123.568 29.756C124.552 29.756 125.476 29.936 126.34 30.296C127.228 30.632 128.008 31.148 128.68 31.844C129.376 32.54 129.916 33.404 130.3 34.436C130.708 35.468 130.912 36.656 130.912 38C130.912 38.264 130.912 38.588 130.912 38.972C130.912 39.356 130.9 39.68 130.876 39.944H119.968C120.016 40.616 120.16 41.204 120.4 41.708C120.664 42.188 120.988 42.596 121.372 42.932C121.78 43.244 122.224 43.484 122.704 43.652C123.208 43.796 123.712 43.868 124.216 43.868C124.72 43.868 125.188 43.832 125.62 43.76C126.076 43.664 126.508 43.508 126.916 43.292C127.348 43.076 127.756 42.764 128.14 42.356L130.444 44.624C129.892 45.272 129.28 45.812 128.608 46.244C127.936 46.652 127.204 46.952 126.412 47.144C125.644 47.336 124.84 47.432 124 47.432ZM120.004 36.524H126.52C126.52 35.996 126.448 35.528 126.304 35.12C126.184 34.712 125.98 34.376 125.692 34.112C125.428 33.848 125.104 33.656 124.72 33.536C124.336 33.392 123.892 33.32 123.388 33.32C122.956 33.32 122.548 33.38 122.164 33.5C121.78 33.62 121.432 33.812 121.12 34.076C120.832 34.34 120.592 34.676 120.4 35.084C120.208 35.492 120.076 35.972 120.004 36.524ZM134.404 30.152H139.12L139.084 34.832L138.58 34.58C138.652 33.86 138.844 33.212 139.156 32.636C139.468 32.036 139.864 31.52 140.344 31.088C140.848 30.656 141.388 30.332 141.964 30.116C142.564 29.876 143.176 29.756 143.8 29.756C144.76 29.756 145.624 29.912 146.392 30.224C147.16 30.536 147.868 31.028 148.516 31.7L146.608 35.588L146.5 35.876L146.14 35.732C146.068 35.54 145.996 35.336 145.924 35.12C145.876 34.904 145.72 34.652 145.456 34.364C145.12 34.124 144.76 33.92 144.376 33.752C143.992 33.584 143.572 33.5 143.116 33.5C142.54 33.5 142 33.596 141.496 33.788C141.016 33.956 140.596 34.232 140.236 34.616C139.876 35 139.588 35.492 139.372 36.092C139.156 36.668 139.048 37.376 139.048 38.216V47H134.404V30.152ZM155.68 53.336C154.504 53.336 153.448 53.108 152.512 52.652C151.576 52.22 150.712 51.572 149.92 50.708L152.404 47.432L152.62 47.18L152.944 47.36C152.992 47.552 153.028 47.744 153.052 47.936C153.1 48.152 153.244 48.416 153.484 48.728C153.772 48.992 154.084 49.196 154.42 49.34C154.78 49.508 155.2 49.592 155.68 49.592C156.256 49.592 156.724 49.472 157.084 49.232C157.444 48.992 157.696 48.62 157.84 48.116C157.984 47.636 158.056 47.036 158.056 46.316V33.752H152.296V30.152H162.7V45.884C162.7 47.66 162.364 49.1 161.692 50.204C161.02 51.308 160.144 52.1 159.064 52.58C158.008 53.084 156.88 53.336 155.68 53.336ZM160.072 27.596C159.304 27.596 158.644 27.344 158.092 26.84C157.564 26.312 157.3 25.688 157.3 24.968C157.3 24.2 157.552 23.564 158.056 23.06C158.584 22.556 159.256 22.304 160.072 22.304C160.816 22.304 161.464 22.568 162.016 23.096C162.592 23.624 162.88 24.248 162.88 24.968C162.88 25.688 162.592 26.312 162.016 26.84C161.464 27.344 160.816 27.596 160.072 27.596ZM173.068 47.432C171.244 47.432 169.816 47 168.784 46.136C167.752 45.248 167.236 44.096 167.236 42.68C167.236 41.768 167.428 40.94 167.812 40.196C168.22 39.428 168.82 38.756 169.612 38.18C170.428 37.604 171.448 37.16 172.672 36.848C173.896 36.512 175.324 36.344 176.956 36.344C177.1 36.344 177.292 36.356 177.532 36.38C177.772 36.38 178.036 36.38 178.324 36.38C178.612 36.38 178.876 36.392 179.116 36.416L179.224 39.512C179.032 39.488 178.78 39.476 178.468 39.476C178.18 39.476 177.88 39.476 177.568 39.476C177.256 39.476 177.004 39.476 176.812 39.476C175.804 39.476 174.976 39.548 174.328 39.692C173.704 39.812 173.2 39.992 172.816 40.232C172.456 40.472 172.204 40.748 172.06 41.06C171.916 41.372 171.844 41.708 171.844 42.068C171.844 42.38 171.892 42.668 171.988 42.932C172.108 43.172 172.264 43.364 172.456 43.508C172.648 43.628 172.876 43.724 173.14 43.796C173.428 43.868 173.728 43.904 174.04 43.904C174.688 43.904 175.252 43.796 175.732 43.58C176.212 43.364 176.608 43.028 176.92 42.572C177.256 42.092 177.496 41.492 177.64 40.772C177.808 40.028 177.892 39.152 177.892 38.144C177.892 36.824 177.76 35.816 177.496 35.12C177.232 34.424 176.86 33.944 176.38 33.68C175.9 33.416 175.3 33.284 174.58 33.284C173.836 33.284 173.128 33.404 172.456 33.644C171.808 33.86 171.148 34.316 170.476 35.012L167.92 32.312C168.928 31.376 170.02 30.716 171.196 30.332C172.396 29.948 173.584 29.756 174.76 29.756C175.792 29.756 176.764 29.876 177.676 30.116C178.612 30.356 179.428 30.752 180.124 31.304C180.844 31.832 181.408 32.576 181.816 33.536C182.224 34.472 182.428 35.648 182.428 37.064V47H177.748V45.416C177.436 45.776 177.112 46.088 176.776 46.352C176.464 46.616 176.116 46.832 175.732 47C175.348 47.144 174.94 47.252 174.508 47.324C174.076 47.396 173.596 47.432 173.068 47.432ZM187.108 37.352V33.68H197.764V37.352H187.108ZM203.092 47V43.328H207.448V28.244H203.308V24.572H216.124V28.244H211.768V43.328H216.304V47H203.092ZM224.62 47V28.388H218.716V24.572H235.24V28.388H228.976V47H224.62ZM243.88 47.468C243.04 47.468 242.332 47.18 241.756 46.604C241.204 46.028 240.928 45.332 240.928 44.516C240.928 43.7 241.204 43.016 241.756 42.464C242.332 41.888 243.04 41.6 243.88 41.6C244.672 41.6 245.356 41.888 245.932 42.464C246.508 43.016 246.796 43.7 246.796 44.516C246.796 45.332 246.508 46.028 245.932 46.604C245.356 47.18 244.672 47.468 243.88 47.468ZM262.456 47.432C261.232 47.432 260.08 47.228 259 46.82C257.944 46.388 257.02 45.788 256.228 45.02C255.436 44.228 254.824 43.304 254.392 42.248C253.96 41.192 253.744 40.028 253.744 38.756C253.744 37.508 253.96 36.344 254.392 35.264C254.824 34.16 255.436 33.2 256.228 32.384C257.02 31.568 257.944 30.932 259 30.476C260.08 29.996 261.244 29.756 262.492 29.756C264.1 29.756 265.492 30.044 266.668 30.62C267.844 31.196 268.78 32.012 269.476 33.068L266.992 35.804L266.74 36.056L266.452 35.84C266.428 35.648 266.392 35.456 266.344 35.264C266.32 35.048 266.188 34.784 265.948 34.472C265.516 34.04 265.024 33.752 264.472 33.608C263.944 33.44 263.332 33.356 262.636 33.356C262.06 33.356 261.52 33.476 261.016 33.716C260.512 33.956 260.056 34.304 259.648 34.76C259.24 35.216 258.916 35.78 258.676 36.452C258.46 37.124 258.352 37.904 258.352 38.792C258.352 39.56 258.472 40.268 258.712 40.916C258.952 41.54 259.264 42.068 259.648 42.5C260.056 42.908 260.512 43.232 261.016 43.472C261.544 43.688 262.084 43.796 262.636 43.796C263.14 43.796 263.62 43.736 264.076 43.616C264.556 43.472 265.024 43.256 265.48 42.968C265.96 42.656 266.416 42.236 266.848 41.708L269.332 44.588C268.42 45.596 267.34 46.328 266.092 46.784C264.868 47.216 263.656 47.432 262.456 47.432ZM278.764 47.396C277.252 47.396 275.884 47.036 274.66 46.316C273.436 45.572 272.464 44.54 271.744 43.22C271.024 41.876 270.664 40.328 270.664 38.576C270.664 36.92 271.024 35.432 271.744 34.112C272.464 32.768 273.436 31.712 274.66 30.944C275.884 30.152 277.252 29.756 278.764 29.756C280.276 29.756 281.644 30.152 282.868 30.944C284.116 31.712 285.1 32.768 285.82 34.112C286.564 35.432 286.936 36.92 286.936 38.576C286.936 40.304 286.564 41.84 285.82 43.184C285.1 44.504 284.116 45.536 282.868 46.28C281.644 47.024 280.276 47.396 278.764 47.396ZM278.764 43.76C279.484 43.76 280.108 43.544 280.636 43.112C281.188 42.68 281.62 42.08 281.932 41.312C282.244 40.52 282.4 39.608 282.4 38.576C282.4 37.472 282.244 36.536 281.932 35.768C281.62 35 281.188 34.412 280.636 34.004C280.108 33.596 279.484 33.392 278.764 33.392C278.092 33.392 277.48 33.596 276.928 34.004C276.4 34.412 275.98 35 275.668 35.768C275.356 36.536 275.2 37.472 275.2 38.576C275.2 39.608 275.356 40.52 275.668 41.312C275.98 42.08 276.4 42.68 276.928 43.112C277.48 43.544 278.092 43.76 278.764 43.76ZM288.088 47V30.152H291.832V31.232C292.12 30.872 292.408 30.584 292.696 30.368C293.008 30.152 293.32 29.996 293.632 29.9C293.968 29.804 294.292 29.756 294.604 29.756C294.988 29.756 295.348 29.816 295.684 29.936C296.044 30.056 296.38 30.248 296.692 30.512C297.004 30.776 297.256 31.16 297.448 31.664C297.712 31.208 298 30.848 298.312 30.584C298.648 30.296 299.032 30.092 299.464 29.972C299.896 29.828 300.376 29.756 300.904 29.756C301.528 29.756 302.056 29.876 302.488 30.116C302.944 30.332 303.304 30.656 303.568 31.088C303.856 31.496 304.06 32.012 304.18 32.636C304.324 33.236 304.396 33.932 304.396 34.724V47H300.508V35.588C300.508 34.94 300.472 34.436 300.4 34.076C300.352 33.716 300.268 33.452 300.148 33.284C300.028 33.116 299.872 33.032 299.68 33.032C299.416 33.032 299.152 33.164 298.888 33.428C298.648 33.668 298.444 34.028 298.276 34.508C298.132 34.988 298.06 35.588 298.06 36.308V47H294.424V35.66C294.424 34.556 294.352 33.824 294.208 33.464C294.064 33.104 293.812 32.924 293.452 32.924C293.26 32.924 293.068 32.996 292.876 33.14C292.708 33.26 292.552 33.464 292.408 33.752C292.264 34.016 292.156 34.34 292.084 34.724C292.012 35.108 291.976 35.564 291.976 36.092V47H288.088Z"
                fill="black"
              />
              <rect width="70" height="70" rx="12" fill="black" />
              <path
                d="M19.412 47V43.328H23.768V28.244H19.628V24.572H32.444V28.244H28.088V43.328H32.624V47H19.412ZM40.94 47V28.388H35.036V24.572H51.56V28.388H45.296V47H40.94Z"
                fill="white"
              />
            </svg>
          </div>
          <div
            style={{
              marginTop: 40,
              fontSize: 40,
              fontWeight: 600,
            }}
          >
            {title}
          </div>
          {company && (
            <div style={{ marginTop: 10, fontSize: 24, color: "#6B7280" }}>
              {company}
            </div>
          )}
        </div>
      ),
      {
        width: 1200,
        height: 630,
      }
    );
  } catch (e) {
    console.log(`${e.message}`);
    return new Response(`Failed to generate the image`, {
      status: 500,
    });
  }
}
